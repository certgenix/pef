I am using Firebase Auth + Firestore and I already confirmed that the user IS created correctly in Firestore.

But after login or registration, my app shows this page:
â€œError Loading Account â€” Weâ€™re having trouble loading your account information.â€

I want you to FIX ALL of the following problems:

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¥ WHAT IS WRONG (Fix These)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. My dashboard tries to load user data from Firestore before it is available.
   â†’ You must add a proper loading state until Firestore returns actual data.

2. My dashboard code assumes role data exists.
   â†’ If professionalData, jobSeekerData, employerData, businessOwnerData, or investorData 
     is undefined, the UI crashes and shows the â€œError Loading Accountâ€ screen.

3. My code relies on fields that may not exist yet.
   â†’ You must add safe fallback values for:
        - user.roles
        - user.professionalData
        - user.jobSeekerData
        - all other role objects

4. If the user doc loads as undefined (Firestore delay), the app incorrectly thinks the account is broken.
   â†’ You must replace the error page with:
       â€œLoading your accountâ€¦â€
       until Firestore confirms document exists.

5. AuthContext or Dashboard might be checking userDoc incorrectly.
   â†’ You must fix the data fetching logic and ensure:
       - Firebase Auth `onAuthStateChanged()` finishes first
       - Firestore `getDoc()` or `onSnapshot()` completes second

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¥ WHAT I WANT YOU TO GENERATE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. A **fixed Dashboard.jsx** that:
   - Loads user data safely
   - Shows a loading spinner while fetching
   - Creates fallback objects instead of throwing errors
   - NEVER shows â€œError Loading Accountâ€ unless truly necessary

2. A **fixed AuthContext.jsx** that:
   - Waits for Firebase Auth state to finish
   - Exposes a proper loading state
   - Ensures user is authenticated before dashboard loads

3. A safe Firestore fetch helper:
   Example:
      if (!doc.exists()) â†’ auto-create minimal user doc

4. Example code:
   const roles = user.roles || {
      professional: false,
      jobSeeker: false,
      employer: false,
      businessOwner: false,
      investor: false
   };

   const professional = user.professionalData || {};

5. Replace CRASHES with safeguards:
   - No more "cannot read properties of undefined"
   - No more error page for missing fields
   - No more dashboard failures due to slow Firestore

6. OPTIONAL:
   If helpful, you may wrap userDoc loading in:
     useEffect(() => onSnapshot(...))

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¥ REQUIREMENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ The code must run in React (Replit environment)
â€¢ Use Firebase v9 modular SDK
â€¢ Use async/await properly
â€¢ Include comments explaining each fix
â€¢ Keep the UI clean and simple
â€¢ Ensure the dashboard loads correctly for ALL role combinations

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¥ FINAL OUTPUT FORMAT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Please output:

1. Updated AuthContext.jsx (full file)
2. Updated Dashboard.jsx (full file)
3. Fallback helpers for undefined role data
4. Optional Firebase rules for safe reads

Make sure the final result FIXES the â€œError Loading Accountâ€ issue completely.

